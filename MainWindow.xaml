<Window x:Class="FluxionJsSceneEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:FluxionJsSceneEditor"
        mc:Ignorable="d"
        Title="Fluxion Scene Editor" Height="700" Width="1200">
    <Window.Resources>
        <Style x:Key="PropLabelStyle" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,8,0" />
            <Setter Property="Foreground" Value="#DDDDDD" />
            <Setter Property="FontSize" Value="12" />
        </Style>

        <Style x:Key="PropTextBoxStyle" TargetType="TextBox">
            <Setter Property="MinWidth" Value="80" />
            <Setter Property="Margin" Value="0,2,0,2" />
            <Setter Property="Padding" Value="6,3" />
        </Style>

        <Style x:Key="PropCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,2,0,2" />
        </Style>

        <Style x:Key="PropGroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,10" />
            <Setter Property="Padding" Value="8" />
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Top toolbar -->
        <ToolBarTray Grid.Row="0">
            <ToolBar>
                <TextBlock Margin="8,0" VerticalAlignment="Center">Scene Name:</TextBlock>
                <TextBox x:Name="SceneNameTextBox" Width="200" />
                <Separator />

                <TextBlock Margin="8,0" VerticalAlignment="Center">Target W:</TextBlock>
                <TextBox x:Name="TargetWidthTextBox" Width="70" Text="1920" />
                <TextBlock Margin="8,0" VerticalAlignment="Center">H:</TextBlock>
                <TextBox x:Name="TargetHeightTextBox" Width="70" Text="1080" />
                <Separator />

                <TextBlock Margin="8,0" VerticalAlignment="Center">Camera X:</TextBlock>
                <TextBox x:Name="CameraXTextBox" Width="80" />
                <TextBlock Margin="8,0" VerticalAlignment="Center">Y:</TextBlock>
                <TextBox x:Name="CameraYTextBox" Width="80" />
                <TextBlock Margin="8,0" VerticalAlignment="Center">Zoom:</TextBlock>
                <TextBox x:Name="CameraZoomTextBox" Width="80" />
                <Separator />

                <Button x:Name="NewSceneButton" Content="New Scene" Click="NewSceneButton_Click" />
                <Button x:Name="ExportButton" Content="Export Scene" Click="ExportButton_Click" />
                <Separator />

                <Button x:Name="OpenProjectFolderButton" Content="Open Project Folder" Click="OpenProjectFolderButton_Click" />
                <Separator />

                <Button x:Name="OpenEngineFolderButton" Content="Engine Folder" Click="OpenEngineFolderButton_Click" />
                <Button x:Name="EngineInfoButton" Content="Engine Info" Click="EngineInfoButton_Click" />
                <TextBlock Margin="6,0" VerticalAlignment="Center" Foreground="#DDDDDD" Text="Engine:" />
                <TextBlock x:Name="EngineFolderPathTextBlock" Width="220" VerticalAlignment="Center" Foreground="#BBBBBB" TextTrimming="CharacterEllipsis" Text="(none)" />
            </ToolBar>
        </ToolBarTray>

        <!-- Main editor area -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="5*" />
                <ColumnDefinition Width="3*" />
            </Grid.ColumnDefinitions>

            <!-- Left sidebar: project + hierarchy -->
            <DockPanel Grid.Column="0" Margin="8">
                <GroupBox Header="Project" DockPanel.Dock="Top" Margin="0,0,0,8">
                    <DockPanel Margin="6">
                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,6">
                            <Button Content="Refresh" Click="RefreshProjectButton_Click" Margin="0,0,8,0" />
                            <TextBlock Text="Folder:" VerticalAlignment="Center" Margin="0,0,6,0" />
                            <TextBlock x:Name="ProjectFolderPathTextBlock" VerticalAlignment="Center" Text="(none)" TextWrapping="Wrap" />
                        </StackPanel>
                        <TreeView x:Name="ProjectTreeView" MouseDoubleClick="ProjectTreeView_MouseDoubleClick" KeyDown="ProjectTreeView_KeyDown" />
                    </DockPanel>
                </GroupBox>

                <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0,0,0,8">
                    <Button Content="Add Sprite" Margin="0,0,8,0" Click="AddSpriteButton_Click" />
                    <Button Content="Add Audio" Margin="0,0,8,0" Click="AddAudioButton_Click" />
                    <Button Content="Add Clickable" Click="AddClickableButton_Click" />
                </StackPanel>
                <TreeView x:Name="HierarchyTreeView" SelectedItemChanged="HierarchyTreeView_SelectedItemChanged" />
            </DockPanel>

            <!-- Visual editor -->
            <Grid Grid.Column="1" Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <StackPanel Orientation="Horizontal">
                    <TextBlock VerticalAlignment="Center" Margin="0,0,8,0">Zoom</TextBlock>
                    <Slider x:Name="ZoomSlider" Minimum="0.25" Maximum="3" Value="1" Width="200" ValueChanged="ZoomSlider_ValueChanged" />
                    <Button Content="Center Camera" Margin="8,0,0,0" Click="CenterCameraButton_Click" />
                    <Separator Margin="8,0" />
                    <CheckBox x:Name="ShowGridCheckBox" Content="Grid" IsChecked="True" VerticalAlignment="Center" Checked="ShowGridCheckBox_Changed" Unchecked="ShowGridCheckBox_Changed" />
                    <TextBlock VerticalAlignment="Center" Margin="8,0,4,0">Grid(px)</TextBlock>
                    <TextBox x:Name="GridSpacingTextBox" Width="60" Text="64" LostFocus="GridSpacingTextBox_LostFocus" />
                </StackPanel>

                <ScrollViewer Grid.Row="1" Background="#222">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="24" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="24" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- Corner -->
                        <Border Grid.Row="0" Grid.Column="0" Background="#2a2a2a" BorderBrush="#444" BorderThickness="0,0,1,1" />

                        <!-- Top ruler -->
                        <Canvas x:Name="RulerTopCanvas" Grid.Row="0" Grid.Column="1" Height="24" Background="#2a2a2a" />

                        <!-- Left ruler -->
                        <Canvas x:Name="RulerLeftCanvas" Grid.Row="1" Grid.Column="0" Width="24" Background="#2a2a2a" />

                        <!-- Scene area (layered canvases) -->
                        <Grid Grid.Row="1" Grid.Column="1" ClipToBounds="True" Background="#333">
                            <Canvas x:Name="GridCanvas" Background="Transparent" IsHitTestVisible="False" />
                            <Canvas x:Name="ContentCanvas" Background="Transparent" IsHitTestVisible="False" />
                            <Canvas x:Name="GizmoCanvas"
                                    Background="Transparent"
                                    Focusable="True"
                                    MouseWheel="EditorCanvas_MouseWheel"
                                    MouseDown="EditorCanvas_MouseDown"
                                    MouseUp="EditorCanvas_MouseUp"
                                    MouseMove="EditorCanvas_MouseMove"
                                    KeyDown="EditorCanvas_KeyDown" />
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </Grid>

            <!-- Properties panel -->
            <Border Grid.Column="2" Margin="8" Background="#2B2B2B" BorderBrush="#444" BorderThickness="1" CornerRadius="4">
                <DockPanel LastChildFill="True">
                    <TextBlock DockPanel.Dock="Top" FontWeight="SemiBold" Foreground="#FFFFFF" Margin="10,8,10,6" Text="Properties" />
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Padding="10,0,10,10">
                        <StackPanel>
                            <GroupBox x:Name="ElementPropsGroup" Style="{StaticResource PropGroupBoxStyle}" Header="Element">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="90" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Name" />
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="PropNameTextBox" Style="{StaticResource PropTextBoxStyle}" />

                                    <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Type" />
                                    <TextBlock Grid.Row="1" Grid.Column="1" x:Name="PropTypeTextBlock" VerticalAlignment="Center" Foreground="#FFFFFF" />
                                </Grid>
                            </GroupBox>

                            <GroupBox x:Name="TransformPropsGroup" Style="{StaticResource PropGroupBoxStyle}" Header="Transform">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="X" />
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="PropXTextBox" Style="{StaticResource PropTextBoxStyle}" />
                                    <TextBlock Grid.Row="0" Grid.Column="2" Style="{StaticResource PropLabelStyle}" Text="Y" />
                                    <TextBox Grid.Row="0" Grid.Column="3" x:Name="PropYTextBox" Style="{StaticResource PropTextBoxStyle}" />

                                    <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Width" />
                                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="PropWidthTextBox" Style="{StaticResource PropTextBoxStyle}" />
                                    <TextBlock Grid.Row="1" Grid.Column="2" Style="{StaticResource PropLabelStyle}" Text="Height" />
                                    <TextBox Grid.Row="1" Grid.Column="3" x:Name="PropHeightTextBox" Style="{StaticResource PropTextBoxStyle}" />
                                </Grid>
                            </GroupBox>

                            <GroupBox x:Name="SpritePropsGroup" Style="{StaticResource PropGroupBoxStyle}" Header="Sprite">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="90" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Image Src" />
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="PropImageSrcTextBox" Style="{StaticResource PropTextBoxStyle}" />
                                </Grid>
                            </GroupBox>

                            <GroupBox x:Name="TextPropsGroup" Style="{StaticResource PropGroupBoxStyle}" Header="Text">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="90" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="70" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Content" />
                                    <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3" x:Name="PropTextContentTextBox" Style="{StaticResource PropTextBoxStyle}" />

                                    <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Font" />
                                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="PropFontFamilyTextBox" Style="{StaticResource PropTextBoxStyle}" />

                                    <TextBlock Grid.Row="1" Grid.Column="2" Style="{StaticResource PropLabelStyle}" Text="Size" />
                                    <TextBox Grid.Row="1" Grid.Column="3" x:Name="PropFontSizeTextBox" Style="{StaticResource PropTextBoxStyle}" />

                                    <TextBlock Grid.Row="2" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Color" />
                                    <TextBox Grid.Row="2" Grid.Column="1" x:Name="PropTextColorTextBox" Style="{StaticResource PropTextBoxStyle}" />
                                </Grid>
                            </GroupBox>

                            <GroupBox x:Name="AudioPropsGroup" Style="{StaticResource PropGroupBoxStyle}" Header="Audio">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="90" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource PropLabelStyle}" Text="Audio Src" />
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="PropAudioSrcTextBox" Style="{StaticResource PropTextBoxStyle}" />

                                    <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,4,0,0">
                                        <CheckBox x:Name="PropAudioLoopCheckBox" Style="{StaticResource PropCheckBoxStyle}" Content="Loop" Margin="0,0,14,0" />
                                        <CheckBox x:Name="PropAudioAutoplayCheckBox" Style="{StaticResource PropCheckBoxStyle}" Content="Autoplay" />
                                    </StackPanel>
                                </Grid>
                            </GroupBox>

                            <GroupBox x:Name="ClickablePropsGroup" Style="{StaticResource PropGroupBoxStyle}" Header="Clickable">
                                <StackPanel>
                                    <CheckBox x:Name="PropHasClickableCheckBox" Style="{StaticResource PropCheckBoxStyle}" Content="Has clickable area" />
                                </StackPanel>
                            </GroupBox>

                            <StackPanel x:Name="PropsButtonsPanel" Orientation="Horizontal" Margin="0,6,0,0">
                                <Button Content="Apply Changes" Click="ApplyChangesButton_Click" Margin="0,0,8,0" />
                                <Button Content="Remove Element" Click="RemoveElementButton_Click" />
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </DockPanel>
            </Border>
        </Grid>

        <!-- Status bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock x:Name="StatusTextBlock" Text="Ready" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
